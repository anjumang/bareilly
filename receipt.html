<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Member Receipt - Anjuman Ghulaman-E-Mustafa</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
/* ======== PURE DESIGN – SAME AS YOUR FILE (NO CHANGE) ======== */
*{margin:0;padding:0;box-sizing:border-box}
body{
font-family:'Segoe UI',system-ui,-apple-system,sans-serif;
background:linear-gradient(135deg,#f8fafc,#e2e8f0);
color:#1e293b;min-height:100vh;padding:20px
}
.container{
max-width:1000px;margin:auto;background:#fff;
border-radius:20px;overflow:hidden;
box-shadow:0 20px 60px rgba(0,0,0,.1)
}
.receipt-header{
background:linear-gradient(135deg,#0b4da0,#083a7f);
color:#fff;padding:25px 30px;border-bottom:5px solid #10b981
}
.header-top{display:flex;justify-content:space-between;align-items:center}
.logo-container{display:flex;gap:15px;align-items:center}
.logo img{width:70px;border-radius:10px}
.header-info{
display:grid;grid-template-columns:repeat(3,1fr);
gap:15px;margin-top:15px;
background:rgba(255,255,255,.1);
padding:15px;border-radius:10px
}
.profile-section{
padding:30px;display:flex;gap:30px;align-items:center;
border-bottom:1px solid #e2e8f0
}
.profile-image{
width:150px;height:150px;border-radius:50%;
border:5px solid #e2e8f0;object-fit:cover
}
.member-name{font-size:2rem;color:#0b4da0;font-weight:700}
.history-section,.summary-cards,.points-section{padding:30px}
.payment-table{width:100%;border-collapse:collapse}
.payment-table th{
background:#0b4da0;color:#fff;padding:12px
}
.payment-table td{
padding:10px;border-bottom:1px solid #e2e8f0
}
.action-buttons{
display:flex;gap:20px;justify-content:center;padding:30px
}
.btn{
padding:14px 35px;border:none;border-radius:10px;
font-weight:600;cursor:pointer
}
.btn-print{background:#0b4da0;color:#fff}
.btn-close{background:#64748b;color:#fff}
@media print{.action-buttons{display:none}}
</style>
</head>

<body>
<div class="container">

<!-- HEADER -->
<div class="receipt-header">
<div class="header-top">
<div class="logo-container">
<img src="https://anjumang.github.io/bareilly/img/logo.png">
<div>
<h1>Anjuman Ghulamane Mustafa</h1>
<p>Official Membership Receipt</p>
</div>
</div>
<div>
<div>Last Updated</div>
<div id="lastUpdatedTime"></div>
</div>
</div>

<div class="header-info">
<div>Receipt No: <b id="receiptNumber"></b></div>
<div>Date: <b id="currentDate"></b></div>
<div>Status: <b id="memberStatus">Loading</b></div>
</div>
</div>

<!-- PROFILE -->
<div class="profile-section">
<img id="memberImage" class="profile-image"
src="https://via.placeholder.com/150/0b4da0/ffffff?text=AGM">
<div>
<div id="memberName" class="member-name">Loading...</div>
<p><i class="fa fa-phone"></i> <span id="memberPhone">-</span></p>
<p>Member Since: <b id="memberSince">-</b></p>
</div>
</div>

<!-- PAYMENT HISTORY -->
<div class="history-section">
<h3>Payment History</h3>
<table class="payment-table">
<thead>
<tr><th>Sr</th><th>Date</th><th>Month</th><th>Amount</th><th>Points</th></tr>
</thead>
<tbody id="paymentHistory">
<tr><td colspan="5" style="text-align:center">Loading…</td></tr>
</tbody>
</table>
</div>

<!-- SUMMARY -->
<div class="summary-cards">
<p>Total Paid: <b id="totalPaid">₹0</b></p>
<p>Total Points: <b id="totalPoints">0</b></p>
</div>

<!-- ACTION -->
<div class="action-buttons">
<button class="btn btn-print" onclick="window.print()">Print</button>
<button class="btn btn-close" onclick="window.close()">Close</button>
</div>

</div>

<script>
/* ===== CONFIG ===== */
const API = "https://anjumang.infinityfreeapp.com/api.php";

/* ===== PARAMS ===== */
const params = new URLSearchParams(location.search);
const name = params.get("name");

/* ===== DATE ===== */
const now = new Date();
document.getElementById("currentDate").innerText =
now.toLocaleDateString("en-IN");
document.getElementById("lastUpdatedTime").innerText =
now.toLocaleTimeString("en-IN");
document.getElementById("receiptNumber").innerText =
"AGM/"+now.getFullYear()+"/"+Math.floor(1000+Math.random()*9000);

/* ===== FETCH ===== */
fetch(`${API}?name=${encodeURIComponent(name)}`)
.then(r=>r.json())
.then(res=>{
if(!res.success){alert("Member not found");return}
const d=res.data;

document.getElementById("memberName").innerText=d.name;
document.getElementById("memberPhone").innerText=d.phone;
document.getElementById("memberImage").src=d.image;
document.getElementById("memberSince").innerText=d.member_since;
document.getElementById("totalPaid").innerText="₹"+d.total_paid;
document.getElementById("totalPoints").innerText=d.total_points;

let status="No Payments";
if(d.total_paid>=1200)status="Payment Complete";
else if(d.total_paid>0)status="Active";
document.getElementById("memberStatus").innerText=status;

const tbody=document.getElementById("paymentHistory");
tbody.innerHTML="";
d.payments.forEach((p,i)=>{
tbody.innerHTML+=`
<tr>
<td>${i+1}</td>
<td>${p.date}</td>
<td>${p.month}</td>
<td>₹${p.payment}</td>
<td>${p.point}</td>
</tr>`;
});
});
</script>
</body>
</html>
